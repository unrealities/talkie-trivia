appId: com.unrealities.talkietrivia
---
- launchApp:
    clearState: true

# 0. WAIT FOR DATA LOAD & DISMISS TOOLTIP
- extendedWaitUntil:
    visible: "Search for a movie title..."
    timeout: 15000

# If the tooltip exists, tap the button to dismiss it. 
# The text "Got it" is usually on that button.
- tapOn: 
    text: "Got it"
    optional: true # In case it doesn't appear

# 1. Handle Onboarding / Login
- tapOn: "Profile.*" 

- extendedWaitUntil:
    visible: "Sign In with Google"
    timeout: 5000

- tapOn: "Sign In with Google" 

- extendedWaitUntil:
    visible: "Sign Out E2E User"
    timeout: 8000

# 2. Go back to Game
- tapOn: "Game.*"
- extendedWaitUntil:
    visible: "Search for a movie title..."
    timeout: 5000

# 3. Search for a wrong movie
- tapOn: "Search for a movie title..."
- inputText: "Titanic"

# Wait for results list to appear (might take a moment after typing)
- extendedWaitUntil:
    visible: "Titanic (1997)"
    timeout: 5000

- tapOn: "Titanic (1997)"

# Verify feedback
- extendedWaitUntil:
    visible: "Not quite! Try again."
    timeout: 3000

# 4. Use a Hint
- tapOn: "Need a Hint?.*" 
- tapOn: "Director"
- extendedWaitUntil:
    visible: "Christopher Nolan"
    timeout: 3000

# 5. Win the Game
- tapOn: "Search for a movie title..."
- inputText: "Inception"
- extendedWaitUntil:
    visible: "Inception (2010)"
    timeout: 3000
- tapOn: "Inception (2010)"

# 6. Verify Win State
- extendedWaitUntil:
    visible: "You Got It!"
    timeout: 5000
- assertVisible: "Share Your Result"

# 7. Verify Persistence
- tapOn: "Profile.*"
- extendedWaitUntil:
    visible: "Games Played: 1"
    timeout: 3000
- assertVisible: "Current Streak: 1"
