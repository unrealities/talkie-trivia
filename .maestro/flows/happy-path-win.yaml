appId: com.unrealities.talkietrivia
---
- launchApp:
    clearState: true

# 0. WAIT FOR DATA LOAD
- extendedWaitUntil:
    visible: "Search for a movie title..."
    timeout: 45000

# DISMISS TOOLTIP 1
- tapOn: 
    text: "Got it"
    optional: true

# 1. Handle Onboarding / Login
- tapOn: "Profile.*" 

- extendedWaitUntil:
    visible: "Sign In with Google"
    timeout: 5000

- tapOn: "Sign In with Google" 

- extendedWaitUntil:
    visible: "Sign Out E2E User"
    timeout: 8000

# 2. Go back to Game
- tapOn: "Game.*"
- extendedWaitUntil:
    visible: "Search for a movie title..."
    timeout: 5000

# 3. Search for a wrong movie
- tapOn: "Search for a movie title..."
- inputText: "Titanic"
- pressKey: Enter
- hideKeyboard

# DISMISS TOOLTIP 2
- extendedWaitUntil:
    visible: "Got it"
    timeout: 5000 
- tapOn: "Got it"

# Select Titanic
- assertVisible:
    id: "result-item-Titanic"
- tapOn:
    id: "result-item-Titanic"

# Verify feedback (Titanic shares Leonardo DiCaprio with Inception, so we get a hint!)
- extendedWaitUntil:
    visible: "You're on the right track with the Actors.*"
    timeout: 3000

# 4. Win the Game
- tapOn: "Search for a movie title..."
- inputText: "Inception"
- pressKey: Enter
- hideKeyboard

# Select Inception
- assertVisible:
    id: "result-item-Inception"
- tapOn: 
    id: "result-item-Inception"

# 5. Verify Win State
- extendedWaitUntil:
    visible: "You Got It!"
    timeout: 5000
- assertVisible: "Share Your Result"

# 6. Verify Persistence
- tapOn: "Profile.*"
- extendedWaitUntil:
    visible: "Statistics"
    timeout: 5000

# Scroll to find stats (Handles small screens)
- scrollUntilVisible:
    element:
        text: "Games Played"
    direction: DOWN
    timeout: 5000

# Check stats exist
- assertVisible: "Games Played"
- assertVisible: "Current Streak"
